<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Argento - Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 95%;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        .customer-link {
            position: absolute;
            left: 20px;
            top: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 10px 15px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .customer-link:hover {
            background: rgba(255,255,255,0.3);
        }
        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        .btn {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        .btn-export {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        .btn-clear {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        .btn-refresh {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        }
        .stats {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 20px;
            margin: 0;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            text-align: center;
        }
        .stat-card {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .table-container {
            overflow-x: auto;
            max-height: 70vh;
            position: relative;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 2000px;
        }
        th, td {
            padding: 10px 12px;
            text-align: right;
            border: 1px solid #e9ecef;
            font-size: 12px;
            white-space: nowrap;
        }
        th {
            background: #2c3e50;
            color: white;
            position: sticky;
            top: 0;
            font-weight: 600;
            z-index: 10;
        }
        th:first-child {
            position: sticky;
            left: 0;
            z-index: 20;
            background: #34495e;
        }
        td:first-child {
            position: sticky;
            left: 0;
            background: #f8f9fa;
            z-index: 5;
        }
        tr:hover {
            background: #f8f9fa;
        }
        .no-orders {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }
        .last-update {
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            color: #666;
            font-size: 14px;
            border-top: 1px solid #e9ecef;
        }
        .column-group {
            background: #34495e !important;
            color: white;
            text-align: center;
            font-weight: bold;
        }
        .auto-field {
            background: #e8f5e8;
        }
        .customer-field {
            background: #fff3cd;
        }
        .sender-field {
            background: #d1ecf1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="customer-link">ğŸ›ï¸ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</a>
            <h1>ğŸ“Š Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Argento - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h1>
            <p>Ø¹Ø±Ø¶ ÙˆØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ù‚Ø§Ù„Ø¨ Ø³Ø¨ÙŠØ¯Ø§Ù</p>
        </div>

        <div class="stats" id="statsContainer">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalOrders">0</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="todayOrders">0</div>
                    <div>Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalRevenue">0</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="lastUpdate">--:--</div>
                    <div>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-export" onclick="exportToExcel()">
                ğŸ“¥ ØªØµØ¯ÙŠØ± Excel ÙƒØ§Ù…Ù„
            </button>
            <button class="btn btn-export" onclick="exportToCSV()">
                ğŸ“¥ ØªØµØ¯ÙŠØ± CSV Ù„Ø³Ø¨ÙŠØ¯Ø§Ù
            </button>
            <button class="btn btn-refresh" onclick="loadOrders()">
                ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <button class="btn btn-clear" onclick="clearOrders()">
                ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
            </button>
            <button class="btn" onclick="addTestOrder()" style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);">
                ğŸ§ª Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ
            </button>
        </div>

        <div class="table-container">
            <table id="ordersTable">
                <thead>
                    <tr>
                        <th rowspan="2">#</th>
                        <th colspan="8" class="column-group">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</th>
                        <th colspan="6" class="column-group">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        <th colspan="6" class="column-group">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        <th rowspan="2">Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØµÙŠÙ„</th>
                    </tr>
                    <tr>
                        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                        <th title="S.O.">S.O.</th>
                        <th title="Goods type">Goods type</th>
                        <th title="Goods name">Goods name</th>
                        <th title="Quantity">Quantity</th>
                        <th title="Weight">Weight</th>
                        <th title="COD">COD</th>
                        <th title="Insure price">Insure price</th>
                        <th title="Whether to allow the package to be opened">Ø§ÙØªØ­ Ø§Ù„Ø·Ø±Ø¯ØŸ</th>
                        <th title="Remark">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                        
                        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„ -->
                        <th title="Name">Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        <th title="Telephone">ØªÙ„ÙÙˆÙ† Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        <th title="City">Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        <th title="Area">Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        <th title="Senders address">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        <th title="Sender Email">Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø±Ø³Ù„</th>
                        
                        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù… -->
                        <th title="Name">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        <th title="Telephone">ØªÙ„ÙÙˆÙ† Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        <th title="City">Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        <th title="Area">Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        <th title="Receivers address">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        <th title="Receiver Email">Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>
                        
                        <!-- Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØµÙŠÙ„ -->
                    </tr>
                </thead>
                <tbody id="ordersBody">
                    <tr>
                        <td colspan="23" class="no-orders">
                            ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="last-update" id="lastUpdateText">
            Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: -- | Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©: 22 Ø¹Ù…ÙˆØ¯ Ø­Ø³Ø¨ Ù‚Ø§Ù„Ø¨ Ø³Ø¨ÙŠØ¯Ø§Ù
        </div>
    </div>

    <script src="data.js"></script>
    <script>
        // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        function loadOrders() {
            try {
                const orders = JSON.parse(localStorage.getItem('argentoOrders')) || [];
                updateStats(orders);
                displayOrders(orders);
                updateLastUpdateTime();
                
            } catch (error) {
                console.error('Error loading orders:', error);
                document.getElementById('ordersBody').innerHTML = `
                    <tr>
                        <td colspan="23" class="no-orders" style="color: #e74c3c;">
                            âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}
                        </td>
                    </tr>
                `;
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats(orders) {
            const today = new Date().toDateString();
            const todayOrders = orders.filter(order => 
                new Date(order.timestamp).toDateString() === today
            ).length;
            
            const totalRevenue = orders.reduce((sum, order) => sum + (parseInt(order.cod) || 0), 0);

            document.getElementById('totalOrders').textContent = orders.length;
            document.getElementById('todayOrders').textContent = todayOrders;
            document.getElementById('totalRevenue').textContent = totalRevenue + ' Ø¬.Ù…';
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function displayOrders(orders) {
            const tbody = document.getElementById('ordersBody');
            
            if (orders.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="23" class="no-orders">
                            ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
                            <br><small>Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ" Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…</small>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = orders.map((order, index) => `
                <tr>
                    <td><strong>${index + 1}</strong></td>
                    
                    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                    <td class="auto-field">${order.so || ''}</td>
                    <td class="auto-field"><strong>${order.goodsType}</strong></td>
                    <td class="auto-field"><strong>${order.goodsName}</strong></td>
                    <td class="auto-field">${order.quantity}</td>
                    <td class="auto-field">${order.weight}</td>
                    <td class="auto-field" style="color: #27ae60; font-weight: bold;">${order.cod} Ø¬.Ù…</td>
                    <td class="auto-field">${order.insurePrice || ''}</td>
                    <td class="auto-field">${order.allowOpen}</td>
                    <td class="auto-field"><small>${order.remark || '-'}</small></td>
                    
                    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„ -->
                    <td class="sender-field"><strong>${order.senderName}</strong></td>
                    <td class="sender-field" dir="ltr">${order.senderTelephone}</td>
                    <td class="sender-field">${order.senderCity}</td>
                    <td class="sender-field">${order.senderArea}</td>
                    <td class="sender-field"><small>${order.senderAddress}</small></td>
                    <td class="sender-field">${order.senderEmail || '-'}</td>
                    
                    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù… -->
                    <td class="customer-field"><strong>${order.receiverName}</strong></td>
                    <td class="customer-field" dir="ltr">${order.receiverTelephone}</td>
                    <td class="customer-field">${order.receiverCity}</td>
                    <td class="customer-field">${order.receiverArea}</td>
                    <td class="customer-field"><small>${order.receiverAddress}</small></td>
                    <td class="customer-field">${order.receiverEmail || '-'}</td>
                    
                    <!-- Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØµÙŠÙ„ -->
                    <td class="auto-field"><strong>${order.deliveryType}</strong></td>
                </tr>
            `).join('');
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ar-EG');
            const dateString = now.toLocaleDateString('ar-EG');
            
            document.getElementById('lastUpdate').textContent = timeString;
            document.getElementById('lastUpdateText').textContent = 
                `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${dateString} - ${timeString} | Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©: 22 Ø¹Ù…ÙˆØ¯ Ø­Ø³Ø¨ Ù‚Ø§Ù„Ø¨ Ø³Ø¨ÙŠØ¯Ø§Ù`;
        }

        // Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ
        function addTestOrder() {
            const testOrder = {
                so: "",
                goodsType: "Normal",
                goodsName: "Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ© ØªØ¬Ø±ÙŠØ¨ÙŠØ©",
                quantity: "1",
                weight: "1",
                cod: "350",
                insurePrice: "",
                allowOpen: "No",
                remark: "Ù‡Ø°Ø§ Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…",
                
                senderName: "argento",
                senderTelephone: "10556881360",
                senderCity: "Sharqia",
                senderArea: "Zagazig",
                senderAddress: "Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©",
                senderEmail: "",
                
                receiverName: "Ø¹Ù…ÙŠÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ",
                receiverTelephone: "01012345678",
                receiverCity: "Cairo",
                receiverArea: "Nasr City",
                receiverAddress: "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù†ØµØ± - Ø¹Ù…Ø§Ø±Ø© 25 - Ø´Ù‚Ø© 10",
                receiverEmail: "test@example.com",
                
                deliveryType: "Deliver",
                timestamp: new Date().toISOString(),
                productPrice: "300",
                shippingPrice: "50"
            };

            let orders = JSON.parse(localStorage.getItem('argentoOrders')) || [];
            orders.push(testOrder);
            localStorage.setItem('argentoOrders', JSON.stringify(orders));
            
            console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ:', testOrder);
            loadOrders();
            
            alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ù†Ø¬Ø§Ø­!\nØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù€ 22 ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.');
        }

        // ØªØµØ¯ÙŠØ± Ù„Ù€ Excel
        function exportToExcel() {
            const orders = JSON.parse(localStorage.getItem('argentoOrders')) || [];

            if (orders.length === 0) {
                alert('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§');
                return;
            }

            let csv = 'S.O.,Goods type,Goods name,Quantity,Weight,COD,Insure price,Whether to allow the package to be opened,Remark,Name,Telephone,City,Area,Senders address,Sender Email,Name,Telephone,City,Area,Receivers address,Receiver Email,Delivery Type\n';
            
            orders.forEach(order => {
                csv += `"${order.so}","${order.goodsType}","${order.goodsName}","${order.quantity}","${order.weight}","${order.cod}","${order.insurePrice}","${order.allowOpen}","${order.remark}","${order.senderName}","${order.senderTelephone}","${order.senderCity}","${order.senderArea}","${order.senderAddress}","${order.senderEmail}","${order.receiverName}","${order.receiverTelephone}","${order.receiverCity}","${order.receiverArea}","${order.receiverAddress}","${order.receiverEmail}","${order.deliveryType}"\n`;
            });

            const blob = new Blob(["\uFEFF" + csv], { type: 'text/csv; charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ø·Ù„Ø¨Ø§Øª-argento-ÙƒØ§Ù…Ù„Ø©-${new Date().toLocaleDateString('ar-EG')}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert(`âœ… ØªÙ… ØªØµØ¯ÙŠØ± ${orders.length} Ø·Ù„Ø¨ Ø¨Ù†Ø³Ø®Ø© Excel ÙƒØ§Ù…Ù„Ø©`);
        }

        // ØªØµØ¯ÙŠØ± CSV Ø¬Ø§Ù‡Ø² Ù„Ø³Ø¨ÙŠØ¯Ø§Ù
        function exportToCSV() {
            const orders = JSON.parse(localStorage.getItem('argentoOrders')) || [];

            if (orders.length === 0) {
                alert('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§');
                return;
            }

            // ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ù…Ù„Ù Ø­Ø³Ø¨ Ù‚Ø§Ù„Ø¨ Ø³Ø¨ÙŠØ¯Ø§Ù
            let csv = 'S.O.,Goods type,Goods name,Quantity,Weight,COD,Insure price,Whether to allow the package to be opened,Remark,Name,Telephone,City,Area,Senders address,Sender Email,Name,Telephone,City,Area,Receivers address,Receiver Email,Delivery Type\n';
            
            orders.forEach(order => {
                csv += `"${order.so}","${order.goodsType}","${order.goodsName}","${order.quantity}","${order.weight}","${order.cod}","${order.insurePrice}","${order.allowOpen}","${order.remark || ''}","${order.senderName}","${order.senderTelephone}","${order.senderCity}","${order.senderArea}","${order.senderAddress}","${order.senderEmail}","${order.receiverName}","${order.receiverTelephone}","${order.receiverCity}","${order.receiverArea}","${order.receiverAddress}","${order.receiverEmail || ''}","${order.deliveryType}"\n`;
            });

            const blob = new Blob(["\uFEFF" + csv], { type: 'text/csv; charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `speedaf-orders-${new Date().toLocaleDateString('ar-EG')}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert(`âœ… ØªÙ… ØªØµØ¯ÙŠØ± ${orders.length} Ø·Ù„Ø¨ Ø¬Ø§Ù‡Ø² Ù„Ø±ÙØ¹ Ø³Ø¨ÙŠØ¯Ø§Ù`);
        }

        // Ù…Ø³Ø­ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        function clearOrders() {
            const orders = JSON.parse(localStorage.getItem('argentoOrders')) || [];

            if (orders.length === 0) {
                alert('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù„Ù„Ù…Ø³Ø­');
                return;
            }

            if (confirm(`âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù ${orders.length} Ø·Ù„Ø¨ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¹Ø§Ø¯ØªÙ‡Ù…!`)) {
                localStorage.removeItem('argentoOrders');
                loadOrders();
                alert('âœ… ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        // Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        window.addEventListener('load', function() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...');
            loadOrders();
        });

        // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ
        setInterval(loadOrders, 10000);

        // Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ø°Ø§ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª
        setTimeout(() => {
            const orders = JSON.parse(localStorage.getItem('argentoOrders')) || [];
            if (orders.length === 0) {
                console.log('ğŸ”„ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§ØªØŒ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ');
            }
        }, 2000);
    </script>
</body>
</html>
